## +
## ===================================================================
## Copyright(C) 2010 - 2012 Basefount Technology (Hong Kong) Limited.
## and/or its licensors.  All rights reserved.
##
## The coded instructions, statements, computer programs, and/or
## related material (collectively the "Data") in these files contain
## unpublished information proprietary to Basefount Technology
## (Hong Kong) Limitd. ("Basefount") and/or its licensors, which is
## protected by Hong Kong copyright law and by international treaties.
##
## The Data is provided for use exclusively by You. You have the right 
## to use, modify, and incorporate this Data into other products for 
## purposes authorized by the Basefount software license agreement, 
## without fee.
##
## The copyright notices in the Software and this entire statement, 
## including the above license grant, this restriction and the 
## following disclaimer, must be included in all copies of the 
## Software, in whole or in part, and all derivative works of 
## the Software, unless such copies or derivative works are solely 
## in the form of machine-executable object code generated by a 
## source language processor.
##
## THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND. 
## BASEFOUNT DOES NOT MAKE AND HEREBY DISCLAIMS ANY EXPRESS OR
## IMPLIED WARRANTIES INCLUDING, BUT NOT LIMITED TO, THE WARRANTIES
## OF NON-INFRINGEMENT, MERCHANTABILITY OR FITNESS FOR A PARTICULAR 
## PURPOSE, OR ARISING FROM A COURSE OF DEALING, USAGE, OR 
## TRADE PRACTICE. IN NO EVENT WILL BASEFOUNT AND/OR ITS LICENSORS 
## BE LIABLE FOR ANY LOST REVENUES, DATA, OR PROFITS, OR SPECIAL, 
## DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES, EVEN IF BASEFOUNTAIN 
## AND/OR ITS LICENSORS HAS BEEN ADVISED OF THE POSSIBILITY 
## OR PROBABILITY OF SUCH DAMAGES.
##
## ===================================================================
## -

## +
## ===================================================================
##  Module Name: McdPlacementEditorGUI.py
##
##  Description:
##    Placement Editor GUI.
##
## ===================================================================
## -

import maya.cmds as cmds
import maya.mel as mel
from McdGeneral import *

import McdPlacementEditor
reload(McdPlacementEditor)
from McdPlacementEditor import *


def McdPlacementEditorGUI():
    
    winName = "McdPlacementEditor"
    if cmds.window(winName, ex = True):
        cmds.deleteUI(winName)
    
    allAgents = FindAndPutAllAgents()
    globalNode = McdGetMcdGlobalNode()
    startID = cmds.getAttr(globalNode + ".placeAgent[0]")
    endID = cmds.getAttr(globalNode + ".placeAgent[1]")
    
    cmds.window(winName, title = "Placement Editor (AF)",rtf =True,menuBar=True, width=500)
    
    cmds.menu( label='Options')
    cmds.menuItem( label='Refresh contents', c = "McdRefreshPlacementEditor()")
    cmds.menuItem( label='Help' )
    cmds.menuItem( divider=True )
    cmds.menuItem( label='Exit', c = "McdExitPlacementEditor()" )
    
    form = cmds.formLayout()
    tabs = cmds.tabLayout(innerMarginWidth=5, innerMarginHeight=5)
    cmds.formLayout( form, edit=True, attachForm=((tabs, 'top', 0), (tabs, 'left', 0), \
                                                (tabs, 'bottom', 0), (tabs, 'right', 0)) )
    
    #--------------------------  Main GUI  --------------------------#
    
    # proportion setup
    # attatch terrain
    # attatch curve
    # create genZone
    # placement and de-placement
    
    
    child0 = cmds.columnLayout(adj = True)
    
    cmds.columnLayout(adj = True)
    cmds.text(l = "Proportion Setup", fn = "smallBoldLabelFont", align = "left", width = 250)
    
    cmds.rowColumnLayout(nc = 5, cw = [(1, 100), (2, 90), (3, 40), (4, 20), (5, 30)])
    for i in range(len(allAgents)):
        stri = str(i)
        cmds.textField("tf_pe_agtN" + stri, tx = allAgents[i], ed = False)
        cmds.intSlider("is_pe_pro" + stri, min = 0, max = 100, v = 0, \
                                                        cc = "is_pe_cCommand(" + stri + ")", \
                                                        dc = "is_pe_dCommand(" + stri + ")")
        cmds.intField("if_pe_is" + stri, ed = False, v = 0)
        cmds.text(l = "%")
        cid = McdFromAgentName2ID(allAgents[i])
        drawColor = setColorOfDraw(cid)
        cmds.text(l = str(cid), bgc = drawColor)
    cmds.setParent("..")
    
    #reset the silder and value!
    proportionList = ReadProportion(allAgents)
    
    cmds.rowColumnLayout(nc = 4, cw = [(1, 80), (2, 80), (3, 80), (4, 80)])
    cmds.button(l = "Make Even", c = "makePlacementEven()")
    cmds.setParent("..")

    # --------------------------------------------------------------------------
    cmds.text(l = "")
    cmds.text(l = "Individual Placer Editor", fn = "smallBoldLabelFont", align = "left", width = 250)
    
    cmds.rowColumnLayout(nc = 2, cw = [(1, 60), (2, 80)])
    cmds.text(align = "left", l = "Editing ID:")
    cmds.intField("placerID", min = 0, v = 0)
    cmds.setParent("..")
    
    
    cmds.rowColumnLayout(nc = 4, cw = [(1, 25), (2, 80), (3, 80), (4, 80)])
    cmds.text(l = "tx")
    cmds.button(l = "<--", c = "addPlaceOffsetRecord(1, 0)")
    cmds.floatField("ff_off1", v = 1)
    cmds.button(l = "-->", c = "addPlaceOffsetRecord(1, 1)")
    
    cmds.text(l = "tz")
    cmds.button(l = "<--", c = "addPlaceOffsetRecord(3, 0)")
    cmds.floatField("ff_off3", v = 1)
    cmds.button(l = "-->", c = "addPlaceOffsetRecord(3, 1)")
    
    cmds.text(l = "ry")
    cmds.button(l = "<--", c = "addPlaceOffsetRecord(5, 0)")
    cmds.floatField("ff_off5", v = 12)
    cmds.button(l = "-->", c = "addPlaceOffsetRecord(5, 1)")
    
    cmds.text(l = "")
    cmds.text(l = "")
    cmds.text(l = "")
    cmds.text(l = "")
    
    cmds.text(l = "ty")
    cmds.button(l = "<--", c = "addPlaceOffsetRecord(2, 0)")
    cmds.floatField("ff_off2", v = 1)
    cmds.button(l = "-->", c = "addPlaceOffsetRecord(2, 1)")
    
    cmds.text(l = "rx")
    cmds.button(l = "<--", c = "addPlaceOffsetRecord(4, 0)")
    cmds.floatField("ff_off4", v = 12)
    cmds.button(l = "-->", c = "addPlaceOffsetRecord(4, 1)")
    
    cmds.text(l = "rz")
    cmds.button(l = "<--", c = "addPlaceOffsetRecord(6, 0)")
    cmds.floatField("ff_off6", v = 12)
    cmds.button(l = "-->", c = "addPlaceOffsetRecord(6, 1)")
    
    cmds.setParent("..")
    
    cmds.rowColumnLayout(nc = 2, cw = [(1, 133), (2, 132)])
    cmds.button(l = "Clear Current Record", c = "clearCurrentRecord()")
    cmds.button(l = "Clear All Records", c = "clearAllRecord()")
    cmds.setParent("..")
    
    cmds.text(l = "")
    cmds.text(l = "Range Placement", fn = "smallBoldLabelFont", align = "left", width = 250)
    
    cmds.rowColumnLayout(nc = 2, cw = [(1, 60), (2, 80)])
    cmds.text(align = "left", l = "Start ID")
    cmds.intField("plStartID", min = 0, v = startID, cc = 'setGlobal("' + globalNode + '", 0)')
    cmds.text(align = "left", l = "End ID")
    cmds.intField("plEndID", min = 0, v = endID, cc = 'setGlobal("' + globalNode + '", 1)')
    cmds.setParent("..")
    cmds.button(l = "Range Place Agent", c = "placementAgentRange()")
    cmds.button(l = "De - Place", c = "dePlacementAgent()")
    
    cmds.setParent("..")
    
    cmds.setParent("..")
    
    
    #------------------------- Cricial Help -------------------------#
    child1 = cmds.columnLayout(adj = True)
    cmds.text(l = "The proportion setup only deal with the agent which\noriginal agent exist", align = "left")
    cmds.button(l = "Check detailed help", h = 40)
    cmds.setParent( '..' )
    
    #------------------------- table layout -------------------------#
    cmds.tabLayout( tabs, edit=True,tabLabel=((child0, "Logic Table"),\
                                            (child1, "Quick Tips")))
    cmds.showWindow(winName)

    
def McdRefreshPlacementEditor():
    McdPlacementEditorGUI()

def McdExitPlacementEditor():
    try:
        cmds.deleteUI("McdPlacementEditor")
    except:
        pass


